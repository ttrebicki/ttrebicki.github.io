var Ne=Object.defineProperty,Me=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var ie=(e,t,o)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))xe.call(t,o)&&ie(e,o,t[o]);if(ne)for(var o of ne(t))Fe.call(t,o)&&ie(e,o,t[o]);return e},E=(e,t)=>Me(e,We(t));var V=(e,t,o)=>new Promise((n,r)=>{var s=m=>{try{a(o.next(m))}catch(l){r(l)}},c=m=>{try{a(o.throw(m))}catch(l){r(l)}},a=m=>m.done?n(m.value):Promise.resolve(m.value).then(s,c);a((o=o.apply(e,t)).next())});import{t as B,E as Q,eT as He,eU as $e,bI as ye,eG as Se,eV as je,eW as Ve,eX as qe,dG as Ge,y as i,cF as ze,r as D,ax as N,aS as ve,aZ as X,eY as Ke,eZ as se,_ as Ye,e_ as ae,aE as Je,C as Qe,u as k,i as W,c as v,G as Xe,aj as Ze,b5 as ce,e$ as S,f0 as et,f1 as tt,ab as Ce,cA as ot,b as rt,f2 as nt,dX as le,f3 as it,j as ue,f4 as me,bZ as st,dc as at,du as ct,aD as q,a9 as de,eI as u,F as lt,be as Pe,f5 as ut,f6 as mt,f7 as dt,ej as pt,O as A,dr as ft,bk as ht,h as gt,f8 as bt,aJ as Z,e1 as _t,m as ee,f9 as pe,ah as yt,c2 as St}from"./tracking-257878d4.js";import{P as vt}from"./Providers-dd23509f.js";import{o as Ct,p as Pt}from"./tooltip_portal-f6e04b88.js";import{u as wt,F as O,O as Et,c as te,b as fe,T,U as At,q as Tt}from"./index-a43bdb3f.js";import{m as Rt}from"./app_install_modal-56230d83.js";import{q as Lt,r as It}from"./CommunityPostView-bd7ff930.js";import{u as Ot}from"./link_button-08d92dc3.js";import{C as Ut,L as kt,a as Bt}from"./comments_page-b9127f9c.js";import{r as Dt,a as Nt}from"./utils-9af33775.js";import{S as Mt}from"./Progress-839ace4c.js";import{S as Wt,e as xt}from"./entry-62fd6318.js";import{s as we,C as Ft}from"./CloseIcon-2bf3cdcf.js";import{f as Ht,a as $t,c as jt,b as Vt}from"./profile-fdc2a2f6.js";import{N as qt}from"./NavbarUserWidget-c9a2bf99.js";import{F as Gt}from"./user_indicator-71612e4a.js";import{V as zt,J as Kt}from"./Downloads-f5643c9a.js";import{O as oe}from"./Tooltip-73acf10b.js";import{E as Yt,P as Jt}from"./ShowsVideoPlayer-30608faf.js";import{d as Qt}from"./decodeHtmlEntitiesFast-5e803c22.js";import{e as U}from"./encodeHtmlEntities-e3f5cd4a.js";import{B as Ee}from"./Button-7aa42593.js";import{PublicationSearch as Xt}from"./PublicationSearch-429f0f65.js";import{r as Zt}from"./sortBy-342a0ebf.js";import{a as eo}from"./Modal-ced80e2c.js";import{P as to}from"./Avatar-4d787044.js";import{C as oo}from"./ElevatedTheme-c517414e.js";import{S as ro}from"./share_dialog-486c820c.js";import"./free_email_form.module-5c7a08c2.js";import"./user-4be0abd7.js";import"./fetchJson-00ddb03a.js";import"./LazyComponent-85b1eafe.js";import"./mousetrap-0161e61a.js";import"./publicationUserSettings-346eeb87.js";import"./publication-7a688089.js";import"./x-1688dcfe.js";import"./HoverCard-975488ff.js";import"./DarkTheme-96666a68.js";import"./Divider.module-6a7511d0.js";import"./transition-f3b77fed.js";import"./react-laag.esm-fe7bfc96.js";import"./theme-e69a7f6d.js";import"./ProfileHoverCard-438a4664.js";import"./uniqBy-70655f43.js";import"./_baseIteratee-57f3214a.js";import"./noop-a400910c.js";import"./Menu-a95bbec4.js";import"./UserBadge-077e4ff5.js";import"./recentSurfaces-856a1c30.js";import"./store-04f84ce1.js";import"./SkinnyLockIcon-38c57a0d.js";import"./debounce-a82cd5f5.js";import"./toNumber-a5db2642.js";import"./uniq-1a51e0ed.js";import"./search-73992fca.js";import"./SubstackIconNoPadding-c86beeab.js";import"./podcasts-674be6b7.js";import"./captcha-f8136f8b.js";import"./ImageViewerModal-b414e5fd.js";import"./download-7e744bb2.js";import"./AlertDialog-61679e84.js";import"./_createAggregator-96e8e847.js";import"./TextInput-a8025bc1.js";import"./Input.module-46d40b0c.js";import"./ReaderReferralTiers-99f317e1.js";import"./mention-f87c0d24.js";import"./date-2e706f46.js";import"./settings-2-ea548f8f.js";import"./util-typed-d1fed5e0.js";import"./menu-1e4fd18d.js";import"./visibility-e2ee85a0.js";import"./info-3a17682e.js";import"./Recipe-7941361b.js";import"./jsesc-f2bd1962.js";import"./Select-cbb6b0ee.js";import"./DropdownIcon-e942395d.js";import"./BurgerIcon-2a624c6d.js";import"./user_profile-8ff5e148.js";import"./modal-5b2a9e5d.js";import"./NewsletterIcon-d2a3d804.js";import"./AppBanner-a7505c9f.js";import"./Metadata-47b0f585.js";import"./useDismissed-2dfe3bd7.js";import"./plus-b4f64f3f.js";import"./CommentBody-b6b9d9fb.js";import"./clamp-dad2a60a.js";import"./Unit-d12afb44.js";import"./isOnReader-d25ceb1a.js";import"./UserBadgeIconOnly-32b55482.js";import"./latex-fa5d868b.js";import"./TermsFooter-9664c9df.js";import"./star-7608c7c4.js";import"./CheckboxField-2a73789b.js";import"./publication-4ba4e870.js";import"./user-93ce9202.js";import"./Popover-e8b09870.js";import"./ChatZero-3706ca63.js";import"./corner-down-right-7e003267.js";import"./PubAccentTheme-738e5c58.js";import"./sparkles-f6710096.js";import"./thread_head-a83382ba.js";import"./CommentMetadata-387182d9.js";import"./post_metadata-7f531dc0.js";import"./partition-dec219e5.js";import"./MenuIcon-97ea2f37.js";import"./CustomerSupportModeForm-21f93f37.js";import"./SegmentedButton-390b8c2f.js";import"./Switch-5950a995.js";import"./SubstackTheme-0b931a6f.js";import"./LockThinIcon-2eb9b351.js";import"./groupBy-9091ee4e.js";import"./SearchModal-c0e6684d.js";import"./combobox-93c101a6.js";import"./list-3b308c31.js";import"./globe-79278edf.js";import"./book-open-d4c4f859.js";import"./chart-candlestick-cd890772.js";import"./util-e5b09a32.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="acebbc46-f165-480b-bf66-eb39d1224225",e._sentryDebugIdIdentifier="sentry-dbid-acebbc46-f165-480b-bf66-eb39d1224225")}catch(o){}})();function no(e){const{customPublicationThemeContext:t}=e;t.includes("welcome")&&io()}function io(){B(Q.COVER_PAGE_SHOWN),He("pageview",{dl:`${document.location.origin}/welcome${document.location.search}`})}function so(e){B(Q.POST_LINK_CLICKED,e)}function ao(e,{isBottom:t}={}){var a;const{post:o,user:n}=e;if(!o||document.location.pathname==="/about")return;const r=(a=document.location.pathname.match(/^\/p\/([^/]+)/))==null?void 0:a[1],s=o.hidden||!($e(n,o)||!ye(o.audience)||!(o!=null&&o.slug)||Se(r)),c={post:o,hasPaywall:s,surface:"publication"};t?je(c):Ve(E(g({},c),{markRead:!!n}))}let L;function co(){return L}function lo(e){const t=C(e,{fitWidth:!1,fitHeight:!1});return t.style.position="fixed",t.style.zIndex="3999999",t.addEventListener("load",()=>{L=t.contentDocument.createElement("div"),t.contentDocument.body.appendChild(L),typeof MutationObserver!="undefined"&&new MutationObserver(()=>{K(t)}).observe(L,{childList:!0,subtree:!0,attributes:!0,characterData:!0})},{once:!0}),t}function x(e,t){const o=L.ownerDocument.createElement("div");L.appendChild(o),Ae(e,o,t)}function K(e,{recheckForTransitions:t=!0}={}){e.style.top="0",e.style.right="0",e.style.height="100%",e.style.width="100%",e.contentDocument.body.style.top="0";const o=qe(L,s=>{if(s.getBoundingClientRect){const c=s.getBoundingClientRect();if(c.height&&c.width){const a=getComputedStyle(s);if(a.opacity!=="0"&&a.pointerEvents!=="none")return!0}}return!1},{maxDepth:4});if(!o)return e.style.top="0",e.style.right="0",e.style.height="0",e.style.width="0",e.contentDocument.body.style.top="0",!1;const n=o.getBoundingClientRect(),r=Math.max(e.contentWindow.innerWidth-n.width-n.left,0);return e.style.top=`${n.top}px`,e.style.right="0",e.style.height=`${n.height+n.top+26}px`,e.style.width=`${Math.min(n.width+r*2,window.innerWidth)}px`,e.contentDocument.body.style.top=`${-n.top}px`,t&&(setTimeout(()=>K(e,{recheckForTransitions:!1}),0),setTimeout(()=>K(e,{recheckForTransitions:!1}),500)),!0}function C(e,{component:t,elem:o,fitWidth:n=!1,fitHeight:r=!0}={}){const s=uo(e,{elem:o,fitWidth:n,fitHeight:r});return t&&s.addEventListener("load",()=>{s.contentDocument&&Ae(e,s.contentDocument.body,typeof t=="function"?t({container:s}):t)},{once:!0}),s}function Ae(e,t,o){Ge(i(vt,{pub:e.pub,user:e.user,siteConfigs:e.siteConfigs,hasThemedBackground:!0,language:e.language,country:e.country,experimentInfo:null,portalRoot:co(),shouldLoad:!1,publicationSettings:e.publicationSettings},o),t)}function uo(e,{elem:t,fitWidth:o=!1,fitHeight:n=!0}={}){const r=document.createElement("iframe");return t!=null&&t.className&&(r.className=t.className),r.classList.add("substack-frame-root"),r.frameBorder="0",r.scrolling="no",r.style.height="0",r.style.width="100%",r.style.background="transparent",r.srcdoc=`
      <!DOCTYPE html>
      <html lang="${document.body.lang}">
        <head>
          <title></title>
          <meta charset="utf-8" />
          <base target="_parent">
          <style>
            html, body {
              background: transparent;
            }
            body, h1, h2, h3, h4, h5, h6, p, ol, ul {
              margin: 0;
              padding: 0;
            }
            ${o?`
                  html, body {
                    height: fit-content;
                    width: fit-content;
                  }
                `:""}
          </style>
          <style>${e.frameStylesheetPrefix}</style>
          ${e.frameStylesheets.map(s=>`<link rel="stylesheet" type="text/css" href="${s}" />`).join("")}
        </head>
        <body class="substack-frame-body"></body>
      </html>
    `.replace(/\s+/g," "),e.frameStylesheets.forEach(s=>{if(s.match(/theme\/main\.(\w*\.)?css/))return;const c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href=s,document.head.appendChild(c)}),r.addEventListener("load",()=>{r.contentDocument.body.addEventListener("click",mo),(o||n)&&(he(r,o,n),typeof ResizeObserver!="undefined"&&new ResizeObserver(()=>{setTimeout(()=>{he(r,o,n)},0)}).observe(r.contentDocument.body))},{once:!0}),t?(t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t)):document.body.appendChild(r),r}function he(e,t,o){const n=e.contentDocument.documentElement.getBoundingClientRect();o&&(e.style.height=`${n.height}px`),t&&(e.style.width=`${n.width}px`)}function mo(e){if(e.defaultPrevented)return;const t=ze(e.target,o=>o.href);t&&D(t.href,{event:e,local_navigation:!1})}const po=({pub:e,user:t,post:o,extraPaddingForCustomPublicationThemeEmbed:n})=>{var d,f,h,_,y,I,re;const{iString:r}=wt(),s=Lt(),c=Rt(),a=Ot({pathname:`/api/v1/post/${o.id}/comments_summary`,auto:!0,deps:[o]}),m=N(w=>{a.setResult({comments:[w].concat(a.result.comments)})},[a]),l=N(w=>{a.setResult({comments:Dt(a.result.comments,w)})},[a]),P=N(w=>{D(ve(Nt(w)),{local_navigation:!1})},[]),p=N(w=>{D(X(e,o,{comments:!0}),{event:w,local_navigation:!1})},[e,o]);return i(O,{style:n?{paddingTop:2,paddingRight:2}:void 0},a.isLoading?i(Mt,null):Ke(t,o)||se(t,o,e).canReply||((h=(f=(d=a.result)==null?void 0:d.comments)==null?void 0:f.length)!=null?h:0)>0?i(Ye,null,ae(t,o,e)?i(O,{paddingBottom:12},i(Ut,{user:t,pub:e,post:o,onSuccess:m,tabId:s,surface:c})):o.comment_count>0?i(O,{paddingBottom:12},i(kt,{post:o})):null,i(Bt,{className:"post-page-root-comment-list",key:`post:${o.id}`,user:t,pub:e,post:o,comments:(y=(_=a.result)==null?void 0:_.comments)!=null?y:[],onChange:l,noHoverProfile:!0,onProfileClick:P,hideContextMenu:!0,noRestack:!0}),(o.comment_count>0||((re=(I=a.result)==null?void 0:I.comments)==null?void 0:re.length)>0)&&i(O,{paddingTop:12},i(Et,{priority:"secondary",size:"md",onClick:p},r("See all comments")))):!se(t,o,e).canReply&&ae(t,o,e)&&!o.post_paywall_content_for_google?i(Ct,{user:t,publication:e,post:o,title:o.type==="adhoc_email"?r("Comments on this email are for paid subscribers"):r("Comments on this post are for paid subscribers"),reauthenticationTitle:r("To see the comments, please re-authenticate.")}):null)};function fo(e){if(e.post){const t=Array.from(document.querySelectorAll("[data-substack-comments]"));for(const o of t)C(e,{elem:o,component:i(po,E(g({},e),{extraPaddingForCustomPublicationThemeEmbed:!0}))})}}function ho(e){if(e.hasAttribute("data-members-skip"))return B(Q.COVER_PAGE_MAYBE_LATER_CLICKED),Je.set(Wt.INTRO_POPUP_LAST_HIDDEN_AT,new Date().toJSON(),{expires:365*10}),window.location.href=Qe(window.location.href,{no_cover:"true"}),!0}function go(e){return V(this,null,function*(){var p,d,f,h,_,y;const t=e.querySelector("[data-members-email]");if(!t)throw new Error("Please enter a valid email");const o=t.value;if(!o)throw new Error("Please enter a valid email");const n=e.getAttribute("data-members-section")||null,r=e.querySelector('input[data-members-root][type="checkbox"]'),s=r?r.checked:e.hasAttribute("data-members-root")&&e.getAttribute("data-members-root")!=="false",c=((f=(d=(p=k("referring_pub_ids"))==null?void 0:p.split)==null?void 0:d.call(p,","))==null?void 0:f[0])||void 0,a=((y=(_=(h=k("referring_pub_ids"))==null?void 0:h.split)==null?void 0:_.call(h,","))==null?void 0:y.slice(1))||void 0,m=yield fetch("/api/v1/free",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,first_url:Ht,first_referrer:$t,current_url:jt,current_referrer:Vt,referral_code:k("referralCode"),source:"cover_page",referring_pub_id:c,additional_referring_pub_ids:a,section_slug:n,section_and_root:s})}),l=yield m.json(),P=document.location.href;if(l.prompt_to_login&&(document.location.href=W("/account/login",{redirect:P,email:l.email})),m.status===425)l.requires_confirmation=!0;else if(m.status>=400)throw new Error("Subscription attempt failed");l.requires_confirmation||we(),document.location.href=W("/subscribe",E(g(g({next:P,later:!0,just_signed_up:!0},l.subscription_id&&{subscription_id:l.subscription_id}),l.referral_token&&{referral_token:l.referral_token}),{coupon:k("coupon"),requires_confirmation:l.requires_confirmation?"true":"",utm_source:v.coverPage,email:l.email,skip_redirect_check:!0}))})}var Te=(e=>(e.Loading="loading",e.Invalid="invalid",e.Error="error",e.Success="success",e))(Te||{});const bo={subscribe:go};function _o(e){const t=e.getAttribute("data-members-form");if(t){if(!e.classList.contains("loading")){M(e,"loading");try{Promise.resolve(bo[t](e)).then(()=>{M(e,"success")}).catch(o=>{M(e,"error",{error:o})})}catch(o){M(e,"error",{error:o})}}return!0}}function M(e,t,{error:o}={}){if(e.classList.remove(...Object.values(Te)),t&&e.classList.add(t),t==="loading"?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled"),["error","invalid"].includes(t)){const n=e.querySelector("[data-members-error]");n&&(n.textContent=Xe(o))}}const yo="_UserWidget_lqv8f_1",So={UserWidget:yo},vo=({pub:e,user:t,component:o,showCustomerSupportModeModal:n,isMeetingsActive:r,forceDesktop:s})=>{let c,a;return o==="cta"?(c=!1,a=!0):o==="menu"?(c=!0,a=!1):(c=!1,a=!1),i("div",{className:te(So.UserWidget,"main-menu")},i(Gt.Provider,{value:s},i(qt,{user:t,hide_subscribe_cta:document.location.pathname.startsWith("/subscribe"),pub:e,showCustomerSupportModeModal:n,hideCta:c,hideChat:!0,hideNotifications:!0,hideSearch:!0,hideShare:!0,hideUserIndicator:a,className:null,baseRef:null,freeSignup:t==null?void 0:t.is_free_subscribed,freeSignupEmail:t==null?void 0:t.email,isPublishContext:document.location.pathname.startsWith("/publish"),fixedTooltip:!1,isMeetingsActive:r})))};function Co(e){const t=!!k("showCustomerSupportModeModal"),o=Array.from(document.querySelectorAll("[data-substack-member-widget]"));for(const n of o){let r="all";const s=n.getAttribute("data-substack-member-widget-component");(s==="cta"||s==="menu"||s==="all")&&(r=s);const c=n.getAttribute("data-substack-member-widget-fix-mobile"),a=C(e,{elem:n,component:i(vo,E(g({},e),{showCustomerSupportModeModal:t,component:r,forceDesktop:!!c&&!Ze()}))});a.style.position="absolute",a.style.right="0"}}function Po(e,{pub:t,post:o,user:n}){var c,a;const r=m=>new RegExp(m,"g");let s=e;return o&&n&&(s=s.replace(r(u.COMMENTS_URL),ce(t,o)).replace(r(u.HALF_MAGIC_COMMENTS_URL),ce(t,o))),s.replace(r(u.CHECKOUT_URL),S(et(t))).replace(r(u.FOUNDING_CHECKOUT_URL),S(tt(t))).replace(r(u.ACCOUNT_URL),S(Ce(t,{addBase:!0}))).replace(r(u.ARCHIVE_URL),S(ot(t,{addBase:!0,params:null}))).replace(r(u.PUBLICATION_NAME),S(U(t.name||""))).replace(r(u.PUBLICATION_HERO_TEXT),S(U(t.hero_text||""))).replace(r(u.AUTHOR_NAME),S(U(t.author_name||""))).replace(r(u.AUTHOR_FIRST_NAME),S(U(rt(t.author_name)||""))).replace(r(u.AUTHOR_BIO),S(U(t.author_bio||""))).replace(r(u.SHARE_URL),"").replace(r(u.SHARE_PUB_URL),nt(t)).replace(r(u.PODCAST_SETUP_URL),le(t,{addBase:!0,noSection:!0,params:null,section:null,user:null,startAtSubscribeFlow:!1})).replace(r(u.PERSONAL_PODCAST_SETUP_URL),le(t,{addBase:!0,noSection:!0,params:null,section:null,user:null,startAtSubscribeFlow:!1})).replace(r(u.ALL_PODCASTS_SETUP_URL),it(t,{startAtSubscribeFlow:!0,utm_source:v.allPodcastsSetupButton})).replace(r(u.HOME_LINK),ue(t)).replace(r(u.THREAD_URL),me({pubKey:t.subdomain})).replace(r(u.CHAT_URL),me({pubKey:t.subdomain})).replace(r(u.PREACT_COMPAT_HTML_COMMENT_OPEN),"<!--").replace(r(u.PREACT_COMPAT_HTML_COMMENT_CLOSE),"-->").replace(r(u.DASHBOARD_URL),st(t,{addBase:!0})).replace(r(u.AUTHOR_PHOTO_URL),t.author_photo_url||"").replace(r(u.MEETINGS_URL),at(t,{addBase:!0})||"").replace(r(u.PUBLICATION_URL),ue(t)).replace(r(u.LEADERBOARD_URL),ct(t,void 0,{addBase:!0})).replace(r(u.ACTIVITY_PAGE_URL),`${q()}/activity`).replace(r(u.FOLLOW_PROFILE_URL),n?ve(n,{utm_source:v.email,extraParams:{r:(c=de(n))!=null?c:"",followPrompt:!0}}):W(q(),{utm_source:v.email,followPrompt:!0})).replace(r(u.FOLLOW_POST_URL),n?X(t,o,{urlParams:{utm_source:v.email,r:(a=de(n))!=null?a:"",followPrompt:!0}}):W(q(),{utm_source:v.email,followPrompt:!0}))}const Re="video-tooltip-layer",Le="audio-tooltip-layer",wo="substack-audio-player-container",Eo=(e,t,o)=>{e.querySelectorAll(t).forEach(o)};function Ao(e){var t,o,n,r,s;if(e.post){const c=!!e.siteConfigs.custom_themes_substack_video_player,a=!!e.siteConfigs.custom_themes_substack_audio_player,m=!!e.siteConfigs.custom_themes_substack_player_for_video_embeds,l=Array.from(document.querySelectorAll("[data-substack-content]"));if(l.length>0&&(l[0].insertAdjacentElement("beforebegin",ge(e)),l[l.length-1].insertAdjacentElement("afterend",ge(e,{isBottom:!0}))),(t=e.post)!=null&&t.videoUpload){const{containerDiv:p,playerDiv:d}=G({tooltipId:Re});(o=l[0])==null||o.insertAdjacentElement("beforebegin",p),C(e,{elem:d,component:({container:f})=>{var h;return!f.contentWindow||!((h=e.post)!=null&&h.videoUpload)?null:i(To,{iframeElem:f,mediaUpload:e.post.videoUpload,post:e.post,pub:e.pub,user:e.user,useSubstackVideoPlayer:c})}})}else if(((n=e.post)==null?void 0:n.type)==="podcast"&&a){const{containerDiv:p,playerDiv:d}=G({tooltipId:Le}),f=document.getElementById(wo);f?f.appendChild(p):(r=l[0])==null||r.insertAdjacentElement("beforebegin",p),C(e,{elem:d,component:({container:h})=>e.post?i(Ro,{iframeElem:h,post:e.post,pub:e.pub,user:e.user}):null})}let P=1;for(const p of l)if(Eo(p,"a",d=>{d.addEventListener("click",f=>{var h,_;if(f.preventDefault(),so({post_id:(h=e.post)==null?void 0:h.id,publication_id:(_=e.post)==null?void 0:_.publication_id,url:d.href}),window.location.host===d.host){const y=ut(d.href);if(y!==d.href){D(y,{local_navigation:!1,event:f});return}}mt(d.href)})}),(s=p.className)!=null&&s.match(/native-video-embed/g)&&m){const d=p.getAttribute("data-attrs");if(!d)continue;const{mediaUploadId:f}=JSON.parse(Qt(d)),h=`video-embed-container-${P++}`,{containerDiv:_,playerDiv:y}=G({tooltipId:h});p.appendChild(_),C(e,{elem:y,component:({container:I})=>!I.contentWindow||!e.post?null:i(oe,{layerOptions:{environment:I.contentWindow,container:h,overflowContainer:!1}},i(Yt,{iFrame:I,mediaUploadId:f,post:e.post,pub:e.pub}))})}else if(p.hasAttribute("data-attrs")){const d=Po(p.outerHTML,{pub:e.pub,post:e.post,user:e.user}),f=Pt(d,e.pub,e);f.length>0&&C(e,{elem:p,component:i(Lo,{post:e.post},f)})}}}const To=({iframeElem:e,mediaUpload:t,post:o,pub:n,user:r,useSubstackVideoPlayer:s})=>s&&e.contentWindow?i(oe,{layerOptions:{environment:e.contentWindow,container:Re,overflowContainer:!1}},i(Jt,{iFrame:e,mediaUpload:t,post:o,pub:n,user:r})):i(zt,{mediaUpload:t,pub:n,videoType:"post"}),Ro=({iframeElem:e,post:t,pub:o,user:n})=>{var a;const r=lt(null),s=t.section_id&&(a=o.sections.find(m=>m.id===t.section_id))!=null?a:null;if(!e.contentWindow)return null;const c=!(t!=null&&t.hidden)&&((n==null?void 0:n.is_subscribed)||!ye(t.audience)||!t.slug||Se(t.slug));return i(oe,{layerOptions:{environment:e.contentWindow,container:Le,overflowContainer:!1}},i(It,{audioPlayerRef:r,explicitHeight:340,explicitPodcastUrl:Pe({pub:o})?"/podcasts":void 0,feedUrl:null,hasPaywall:!c,iframeElem:e,isPrivateFeed:!1,isServingFreePodcastUrl:!1,post:t,pub:o,section:s,ufiComponent:null,user:n}))};function Lo({post:e,children:t}){return i("article",{className:te("typography",`${e.type}-post`,"post"),style:{padding:0}},i("div",{className:"body markup",dir:"auto",style:{margin:0}},t))}function ge(e,{isBottom:t}={}){let o=!1;const n=document.createElement("div");n.style.height="0",n.style.padding="0",n.style.margin="0";function r(){if(o){window.removeEventListener("scroll",r);return}const s=n.getBoundingClientRect(),c=Math.max(document.documentElement.clientHeight,window.innerHeight);s.bottom<0||s.top>=c||(ao(e,{isBottom:t}),o=!0)}return window.addEventListener("scroll",r),setTimeout(r,0),n}const G=({tooltipId:e})=>{const t=document.createElement("div");t.style.position="relative";const o=document.createElement("div");t.appendChild(o);const n=document.createElement("div");return n.id=e,n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",t.appendChild(n),{containerDiv:t,playerDiv:o}},Io="_ThemePreviewManagerWrapper_g7v1i_1",Oo="_ThemePreviewManagerButton_g7v1i_10",be={ThemePreviewManagerWrapper:Io,ThemePreviewManagerButton:Oo},Uo=({pub:e})=>i("div",{className:be.ThemePreviewManagerWrapper},i(Ee,{className:be.ThemePreviewManagerButton,variant:"themed-primary",size:"large",href:dt(e)},"Exit theme preview"));function ko(e){if(!e.customPublicationThemePreviewId)return;const t=C(e,{fitWidth:!0,component:i(Uo,g({},e))});t.style.position="fixed",t.style.zIndex="3999998",t.style.bottom="0",t.style.left="0"}const z={"/portal/signin":()=>pt(),"/portal/signup":({pub:e,user:t})=>A(e,{user:t}),"/portal/signup/monthly":({pub:e,user:t})=>A(e,{user:t}),"/portal/signup/yearly":({pub:e,user:t})=>A(e,{user:t}),"/portal/signup/free":({pub:e,user:t})=>A(e,{user:t}),"/portal/account":({pub:e,user:t})=>Ce(e,{signedIn:!!t}),"/portal/account/plans":({pub:e,user:t})=>A(e,{user:t,plan:"founding"}),"/portal/account/plans/metered-post-registration-wall":({pub:e,user:t})=>A(e,{user:t,plan:"annual",utm_source:v.meteredPostRegistrationWall}),"/portal/account/plans/metered-post-paywall":({pub:e,user:t})=>A(e,{user:t,plan:"annual",utm_source:v.meteredPostPaywall}),"/portal/account/profile":({pub:e,user:t})=>ft(t)};function Bo(e){var t;(t=window.addEventListener)==null||t.call(window,"hashchange",()=>Ie(e))}function Ie(e){var n,r,s;const t=(n=window.location.hash)==null?void 0:n.replace(/^#|\/$/g,""),o=(r=z[t])==null?void 0:r.call(z,e);o&&((s=window.history)!=null&&s.replaceState&&window.history.replaceState({},document.title,`${document.location.pathname}${document.location.search}`),window.location.href=o)}function Do(e){const t=e.getAttribute("data-portal");if(t)return window.location.hash=`#/portal/${t}`,!0}const No={"Abigail Shrier":"abigail-shrier","Bari Weiss":"bari-weiss","Coleman Hughes":"coleman-hughes","Douglas Murray":"douglas-murray","Eli Lake":"eli-lake","Francesca Block":"francesca-block","Joe Nocera":"joe-nocera","Katherine Boyle":"katherine-boyle","Leighton Woodhouse":"leighton-woodhouse","Martin Gurri":"martin-gurri","Matti Friedman":"matti-friedman","Michael Shellenberger":"michael-shellenberger","Nellie Bowles":"nellie-bowles","Oliver Wiseman":"oliver-wiseman","Olivia Reingold":"olivia-reingold","Peter Savodnik":"peter-savodnik","Rob Henderson":"rob-henderson","Rupa Subramanya":"rupa-subramanya","Suzy Weiss":"suzy","Vinay Prasad":"vinay-prasad","Walter Kirn":"walter-kirn"};function Mo({pub:e},t){const[o,n]=gt(!1);return bt(t,()=>({open:()=>{n(!0)}})),i(Xt,{isOpen:o,pub:e,onClose:()=>{n(!1)},zIndex:1e4,getUserProfileUrl:Pe({pub:e})?({user:r})=>{if(r.name==="The Free Press")return"/";const s=No[r.name];return s?`/t/${s}`:null}:void 0})}const Wo=ht(Mo),xo="data-ghost-search",Oe=Z();function Fo(e,t){var o;if(e.hasAttribute(xo))return(o=Oe.current)==null||o.open(),!0}function Ho(e){x(e,i(Wo,g({ref:Oe},e)))}const $o="_SubscribeWidgetWrapper_gqnzi_1",jo="_SubscribeWidgetButton_gqnzi_10",_e={SubscribeWidgetWrapper:$o,SubscribeWidgetButton:jo},Vo=({pub:e,user:t,post:o})=>{if(o&&!(t!=null&&t.is_subscribed)&&!(t!=null&&t.is_free_subscribed&&!e.plans))return i("div",{className:_e.SubscribeWidgetWrapper},i(Ee,{className:_e.SubscribeWidgetButton,variant:"themed-primary",size:"large",href:_t(e,{user:t,addBase:!0,params:{utm_source:v.floatingSubscribeButton}})},"Subscribe"))};function qo(e){const t=C(e,{fitWidth:!0,component:i(Vo,g({},e))});t.style.position="fixed",t.style.zIndex="3999998",t.style.bottom="0",t.style.right="0"}const Go="_subscribeDialog_1fe1j_1",zo="_form_1fe1j_11",Ko="_dismissButton_1fe1j_15",Yo="_emailInput_1fe1j_24",Jo="_signInLink_1fe1j_44",Qo="_closeIcon_1fe1j_62",Xo="_submitButton_1fe1j_83",R={subscribeDialog:Go,form:zo,dismissButton:Ko,emailInput:Yo,signInLink:Jo,closeIcon:Qo,submitButton:Xo},Ue="custom_publication_theme_subscribe_modal_seen";let Y,F=!0;try{F=!!(window!=null&&window.localStorage.getItem(Ue))}catch(e){}function Zo(e){var t,o;!e.freeSignup&&e.post&&!F&&(!e.user||((t=e.user)==null?void 0:t.is_free_subscribed)===!1&&((o=e.user)==null?void 0:o.is_subscribed)===!1)&&(!e.post.current_user_post_meter||!e.post.hidden)&&e.siteConfigs.custom_themes_substack_subscribe_modal&&x(e,i(tr,g({ref:n=>Y=n},e)))}function er(){if(!Y||F)return;const e=20,t=window==null?void 0:window.scrollY,o=(document==null?void 0:document.body.scrollHeight)||1;o>t&&t/o*100>=e&&(window.localStorage.setItem(Ue,"true"),F=!0,Y.open())}class tr extends ee{constructor(t){super(t);const{user:o}=t;this.state={isOpen:!1,loading:!1,errors:[],email:(o==null?void 0:o.email)||""}}open(){this.state.isOpen||this.setState({isOpen:!0})}subscribe(){return V(this,null,function*(){var r,s,c,a,m;const{loading:t,email:o}=this.state,{post:n}=this.props;if(!t){this.setState({loading:!0,errors:[]}),B(pe.SUBSCRIBE_PROMPT_SUBMITTED,{post_id:n==null?void 0:n.id});try{yield Zt.post("/api/v1/free").send({email:o,source:"post-subscribe-prompt"}),we(),this.setState({isOpen:!1})}catch(l){(s=(r=l==null?void 0:l.response)==null?void 0:r.body)!=null&&s.error&&typeof l.response.body.error=="string"?this.setState({loading:!1,errors:[l.response.body.error]}):(a=(c=l==null?void 0:l.response)==null?void 0:c.body)!=null&&a.errors&&Array.isArray(l.response.body.errors)&&l.response.body.errors.length>0&&typeof((m=l.response.body.errors[0])==null?void 0:m.msg)=="string"&&this.setState({loading:!1,errors:l.response.body.errors.map(P=>P.msg)})}}})}render(){const{pub:t,post:o,user:n}=this.props,{email:r,loading:s,errors:c}=this.state;return i(eo,{isOpen:this.state.isOpen,onClose:()=>{this.setState({isOpen:!1})}},i(O,{alignItems:"center",className:R.subscribeDialog},i(fe,{justifyContent:"center",alignItems:"end",paddingBottom:20},i(to,{pub:t,size:64}),i("div",{className:R.closeIcon,onClick:()=>this.setState({isOpen:!1})},i(Ft,null))),i(T.H4,{translated:!0,paddingBottom:4,align:"center",color:"pub-primary-text"},"Discover more from ",I18N.p(t.name)),i(T.B4,{color:"pub-secondary-text",paddingBottom:t.rankingDetail?4:24,align:"center"},"Come for news, investigations, and provocative commentary. For us, curiosity isn’t a liability. It’s a necessity."),t.rankingDetail&&i(T.B5,{paddingBottom:24,align:"center",color:"pub-secondary-text"},t.rankingDetailFreeSubscriberCount),i("form",{className:R.form,onSubmit:a=>{a.preventDefault(),this.subscribe()}},i("input",{className:R.emailInput,placeholder:"Type your email...",value:r,disabled:s,onChange:a=>{a.stopPropagation(),a.preventDefault(),this.setState({email:a.currentTarget.value})}}),c&&!!c.length&&i(O,{gap:4,paddingBottom:12},c.map(a=>i(T.Meta,{weight:"semibold",color:"error"},a))),i(At,{className:te(Tt.button,R.submitButton),type:"submit",disabled:s},i(T.B4,{weight:"semibold",color:"pub-accent-inverse"},"Subscribe"))),i(fe,{gap:8,alignItems:"center",justifyContent:"center",className:R.dismissButton,onClick:()=>this.setState({isOpen:!1})},i(T.B4,{translated:!0,weight:"semibold",color:"pub-secondary-text"},"Continue reading"),i(oo,null)),!n&&i(T.B4,{align:"center",className:R.signInLink,weight:"semibold",color:"pub-primary-text"},i("a",{onClick:()=>{B(pe.SUBSCRIBE_PROMPT_SIGN_IN_CLICKED,{post_id:o==null?void 0:o.id}),D(yt({for_pub:t.subdomain,redirect:X(t,o)}))}},"Sign in"))))}}class or extends ee{constructor(t){super(t),this.buttonRef=Z(),this.state={post:null}}toggle(t){this.setState({post:t},()=>{var o;(o=this.buttonRef.current)==null||o.click()})}render({pub:t,user:o,onChange:n},{post:r}){return i(Kt,{pub:t,post:r,user:o,onChange:n,isStatic:!1},({handleLike:s})=>i("a",{ref:this.buttonRef,onClick:s,className:"tw-h-0 tw-w-0 tw-opacity-0"}))}}class rr extends ee{constructor(t){super(t),this.shareDialog=Z(),this.state={post:null}}open(t){this.setState({post:t},()=>{var o;(o=this.shareDialog.current)==null||o.open()})}render(t,{post:o}){return i(ro,E(g({ref:this.shareDialog},t),{post:o,useCustomMenu:!0}))}}const j="data-substack-reaction",ke="data-substack-share",H="reacted";let J,Be;function nr(e,t){if(e.hasAttribute(j)&&J){const o=$(e,t);return o&&J.toggle(o),!0}else if(e.hasAttribute(ke)){const o=$(e,t);return o&&Be.open(o),!0}}function ir(e){x(e,i(rr,g({ref:t=>Be=t},e))),x(e,i(or,E(g({ref:t=>J=t},e),{onChange:({post:t})=>ar(e,t)}))),sr(e)}function sr(e){const t=Array.from(document.querySelectorAll(`[${j}]`));for(const o of t){const n=$(o,e);n&&(n.reaction?o.classList.add(H):o.classList.remove(H))}}function ar(e,t){var n;const o=Array.from(document.querySelectorAll(`[${j}]`));for(const r of o)t.id===((n=$(r,e))==null?void 0:n.id)&&(t.reaction?r.classList.add(H):r.classList.remove(H))}function $(e,t){let o=null;try{const n=e.getAttribute(j)||e.getAttribute(ke);n&&(o=JSON.parse(n))}catch(n){}return o||t.post}const cr=[ho,Do,nr,Fo],b=window._preloads;xt();no(b);Ie(b);Bo(b);lo(b).addEventListener("load",()=>{Co(b),qo(b),Ao(b),fo(b),ir(b),Ho(b),ko(b),Zo(b),St("showWelcome")},{once:!0});document.body.addEventListener("click",e=>{De(e,cr)});document.body.addEventListener("submit",e=>{De(e,[_o])});window.addEventListener("scroll",()=>{er()});function De(e,t){for(let o=e.target;o&&o!==document.documentElement;o=o.parentNode)for(const n of t)if(n(o,b)){e.preventDefault();return}}
